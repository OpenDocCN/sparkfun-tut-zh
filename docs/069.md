# SML 电源板 LiPo 连接指南

> 原文：<https://learn.sparkfun.com/tutorials/sml-power-board-lipo-hookup-guide>

## 介绍

smol 是一种新的主板格式，顾名思义，它们*真的*小！

[![smôl Power Board LiPo](img/bb47ed22ea430eab7f5c440645c2de32.png)](https://www.sparkfun.com/products/18622) 

将**添加到您的[购物车](https://www.sparkfun.com/cart)中！**

 **### [SML 电源板脂](https://www.sparkfun.com/products/18622)

[Only 8 left!](https://learn.sparkfun.com/static/bubbles/ "only 8 left!") SPX-18622

我们的红纸板很棒。但是他们有时候是不是显得有点* * _ 大 _**？！进入* * SML * *，这是一个新系列的主板，它…

$17.95[Favorited Favorite](# "Add to favorites") 1[Wish List](# "Add to wish list")** **SML 电源板 LiPo 是一款用于 SML 的智能电源板。它通过锂离子/锂聚合物电池为您的 SML 堆栈提供 3.3V 电源，并具有内置充电器和电量计。

每个 SML 板的尺寸仅为 1.60 英寸乘 0.42 英寸(40.6 毫米乘 10.7 毫米)。我们把电路板做得足够宽，这样我们就可以在上面挤压 USB-C 和 16 路柔性印刷电路(FPC)连接器。一些电路板在顶层和底层都有元件，这也有助于保持电路板的小型化。

SML 板设计为一个堆叠在另一个之上，使用 16 路 0.5 毫米间距 FPC 来提供板与板之间的互连。每块板在底层有一个 **IN** FPC 连接器，在顶层有一个 **OUT** FPC 连接器。这些板堆叠成之字形菊花链；信号和电源通过 FPC 从一个电路板上下传递到下一个电路板。

### 所需材料

至少，你需要一个锂离子/锂聚合物充电电池来搭配你的电源板:

[![Lithium Ion Battery - 1Ah](img/bd90b8cdb3958c10852269c9b95286f7.png)](https://www.sparkfun.com/products/13813) 

将**添加到您的[购物车](https://www.sparkfun.com/cart)中！**

 **### [锂离子电池-1Ah](https://www.sparkfun.com/products/13813)

[In stock](https://learn.sparkfun.com/static/bubbles/ "in stock") PRT-13813

基于锂离子化学的超薄超轻电池。每个电池在 1000 毫安时输出 3.7V 的标称电压！

$10.958[Favorited Favorite](# "Add to favorites") 75[Wish List](# "Add to wish list")****[![Lithium Ion Battery - 850mAh](img/6fe0bb85d01eec5032a04bf188bb2823.png)](https://www.sparkfun.com/products/13854) 

将**添加到您的[购物车](https://www.sparkfun.com/cart)中！**

 **### [锂离子电池- 850mAh](https://www.sparkfun.com/products/13854)

[In stock](https://learn.sparkfun.com/static/bubbles/ "in stock") PRT-13854

这是基于锂离子化学的非常薄、非常轻的电池。每个电池在 850℃时输出 3.7V 的标称电压…

$10.952[Favorited Favorite](# "Add to favorites") 17[Wish List](# "Add to wish list")****[![Lithium Ion Battery - 400mAh](img/b9437d3680929e692f46b07bfbae16dd.png)](https://www.sparkfun.com/products/13851) 

将**添加到您的[购物车](https://www.sparkfun.com/cart)中！**

 **### [锂离子电池- 400mAh](https://www.sparkfun.com/products/13851)

[In stock](https://learn.sparkfun.com/static/bubbles/ "in stock") PRT-13851

这是一种基于锂离子化学的非常小、非常轻的电池，具有目前最高的能量密度…

$5.5010[Favorited Favorite](# "Add to favorites") 41[Wish List](# "Add to wish list")****[![Lithium Ion Battery - 2Ah](img/d98f217a3e3234215d2dbe87f7bdf233.png)](https://www.sparkfun.com/products/13855) 

将**添加到您的[购物车](https://www.sparkfun.com/cart)中！**

 **### [锂离子电池- 2Ah](https://www.sparkfun.com/products/13855)

[In stock](https://learn.sparkfun.com/static/bubbles/ "in stock") PRT-13855

这是基于锂离子化学的非常薄、非常轻的电池。每个电池在 200 伏时输出一个标称的 3.7 伏电压…

$13.959[Favorited Favorite](# "Add to favorites") 43[Wish List](# "Add to wish list")****[![Lithium Ion Battery - 18650 Cell (2600mAh)](img/77e788de57aafd7cd1811150adac9b2f.png)](https://www.sparkfun.com/products/12895) 

将**添加到您的[购物车](https://www.sparkfun.com/cart)中！**

 **### [锂离子电池- 18650 电芯(2600mAh)](https://www.sparkfun.com/products/12895)

[In stock](https://learn.sparkfun.com/static/bubbles/ "in stock") PRT-12895

不，这不是某种奇怪的 AA 电池，这实际上是一个 18650 锂离子电池。这些圆形的高容量电池…

$6.50[Favorited Favorite](# "Add to favorites") 20[Wish List](# "Add to wish list")****[![Lithium Ion Battery - 6Ah](img/e345e74bc650562ca45c077a5bfc77fe.png)](https://www.sparkfun.com/products/13856) 

将**添加到您的[购物车](https://www.sparkfun.com/cart)中！**

 **### [锂离子电池- 6Ah](https://www.sparkfun.com/products/13856)

[In stock](https://learn.sparkfun.com/static/bubbles/ "in stock") PRT-13856

如果你需要一些果汁，这 6Ah 锂离子电池是给你的。这些是基于锂离子化学电池的非常紧凑的电池…

$32.507[Favorited Favorite](# "Add to favorites") 40[Wish List](# "Add to wish list")************ ************电源板 LiPo 是 smol 生态系统的一部分。为什么不将它与一个 smol 处理器板和一个外设板配对呢？

[![smôl ARTIC R2](img/b0ae460308bf73f8d21c614f05b62092.png)](https://www.sparkfun.com/products/18618) 

将**添加到您的[购物车](https://www.sparkfun.com/cart)中！**

 **### [【北极精灵 R2】](https://www.sparkfun.com/products/18618)

[Out of stock](https://learn.sparkfun.com/static/bubbles/ "out of stock") SPX-18618

我们的红纸板很棒。但是他们有时候是不是显得有点* * _ 大 _**？！进入* * SML * *，这是一个新系列的主板，它…

$199.95[Favorited Favorite](# "Add to favorites") 5[Wish List](# "Add to wish list")****[![smôl ZOE-M8Q](img/1af81a557689725a365b715c79cb8ca8.png)](https://www.sparkfun.com/products/18623) 

将**添加到您的[购物车](https://www.sparkfun.com/cart)中！**

 **### [【smol Zoe-m8q](https://www.sparkfun.com/products/18623)

[30 available](https://learn.sparkfun.com/static/bubbles/ "30 available") SPX-18623

我们的红纸板很棒。但是他们有时候是不是显得有点* * _ 大 _**？！进入* * SML * *，这是一个新系列的主板，它…

$39.95[Favorited Favorite](# "Add to favorites") 4[Wish List](# "Add to wish list")****[![smôl ESP32](img/4ae9404635586af03ffb945630f30c97.png)](https://www.sparkfun.com/products/18619) 

将**添加到您的[购物车](https://www.sparkfun.com/cart)中！**

 **### [smol esp 32](https://www.sparkfun.com/products/18619)

[24 available](https://learn.sparkfun.com/static/bubbles/ "24 available") SPX-18619

我们的红纸板很棒。但是他们有时候是不是显得有点* * _ 大 _**？！进入* * SML * *，这是一个新系列的主板，它…

$17.951[Favorited Favorite](# "Add to favorites") 4[Wish List](# "Add to wish list")****** ******不要忘记，您需要柔性印刷电路将您的 SML 板连接在一起。每块板上需要一个 FPC。如果你想让 SML 板整齐地叠放在一起，我们的 36 毫米 FPC 是最理想的长度。

[![smôl 36mm 16-way Flexible Printed Circuit](img/020986de1157ca59d5fd61bc9bdcb41b.png)](https://www.sparkfun.com/products/18731) 

将**添加到您的[购物车](https://www.sparkfun.com/cart)中！**

 **### [SML 36mm 16 路柔性印刷电路](https://www.sparkfun.com/products/18731)

[In stock](https://learn.sparkfun.com/static/bubbles/ "in stock") CAB-18731

这是用于互连 SML 板的 36 毫米 16 路 0.5 毫米间距柔性印刷电路。* * * * * * SML * *是一个 ec…

$0.95[Favorited Favorite](# "Add to favorites") 2[Wish List](# "Add to wish list")** **需要用 smol 做一些原型制作？或者想要将您的 SML 堆栈连接到 Qwiic 板？SML 割台非常适合这种情况:

[![smôl Header](img/323334e0ff24120c4986a35c5fe1cae8.png)](https://www.sparkfun.com/products/18620) 

将**添加到您的[购物车](https://www.sparkfun.com/cart)中！**

 **### [SML 标题](https://www.sparkfun.com/products/18620)

[Out of stock](https://learn.sparkfun.com/static/bubbles/ "out of stock") SPX-18620

我们的红纸板很棒。但是他们有时候是不是显得有点* * _ 大 _**？！进入* * SML * *，这是一个新系列的主板，它…

$2.95[Favorited Favorite](# "Add to favorites") 2[Wish List](# "Add to wish list")** **

### 推荐阅读

这是 smol 电源板 LiPo 的连接指南。如果您想了解更多关于 smol 的信息，请点击下面的按钮。

[Get started with the smôl Hookup Guide](https://learn.sparkfun.com/tutorials/sml-hookup-guide)

如果您不熟悉以下教程中涵盖的概念，我们建议您浏览这些教程:

[](https://learn.sparkfun.com/tutorials/battery-technologies) [### 电池技术](https://learn.sparkfun.com/tutorials/battery-technologies) The basics behind the batteries used in portable electronic devices: LiPo, NiMH, coin cells, and alkaline.[Favorited Favorite](# "Add to favorites") 50[](https://learn.sparkfun.com/tutorials/i2c) [### I2C](https://learn.sparkfun.com/tutorials/i2c) An introduction to I2C, one of the main embedded communications protocols in use today.[Favorited Favorite](# "Add to favorites") 128

## 硬件概述

在本节中，我们将介绍该板的功能以及 SML 电源板 LiPo 包含的内容。

### 这个板是做什么的？

这个板是做什么的？问得好！让我们现在就回答这个问题。

许多 SparkFun 板，尤其是我们的 [Thing Plus 板](https://www.sparkfun.com/thing_plus)，都配有锂离子电池连接器和内置充电器，因此您可以使用可充电电池为您的项目供电。SML 也不例外。smol 电源板 LiPo 配备了:一个我们的标准 JST-PH 电池连接器；MCP73831 锂离子和锂聚合物充电器；还有一个 MAX17048 I ² C 电池电量表。但它也配有板载 ATtiny841 AVR 微控制器。这是一个*智能*电源板！

电源板的主要工作是为您的 SML 生态系统供电。SML 设计为小尺寸和低电流消耗。电源板在尽可能降低 SML 的电流消耗方面起着关键作用。

当您希望项目进入低功耗或深度睡眠状态时，标准做法是将处理器置于它所提供的最低功耗状态。但是你可能会发现电流消耗仍然在 100 A 到 500 A 之间，这取决于你使用的处理器。然后是电压调节器消耗的静态电流。静态电流是调节器开启但无负载时消耗的电流。同样，它因调节器而异，但您可能会发现这又增加了 55 A 的电流消耗。这些小电流累积起来会大大减少你的电池寿命。

对于 SML，我们采取了一种新的方法。电源板控制并为整个 SML 堆栈提供 3.3V 电源。当处理器板发出指令时，板载 ATtiny 微控制器将完全关闭电源*，然后在预定义的时间间隔内进入低功耗睡眠状态。从几十毫秒到几天的睡眠间隔是可能的。我们使用了神奇的 [Otii 电弧功率分析仪](https://www.sparkfun.com/products/18585)来帮助我们将睡眠电流降低到仅仅 **6 A** 。是的，你没看错，6 微安！smol 让您的电池寿命可以用**个月**来衡量，而不是几天！*

 *### 电池连接器

到目前为止，电路板上最大的组件是电池的 JST-PH 连接器。

[![Pictured is the Battery Connector](img/447adbd9759d551f3ab433d49aa26add.png)](https://cdn.sparkfun.com/assets/learn_tutorials/2/0/5/7/18622_smol_Power_LiPo_Connector.jpg)**Battery Polarity:** Please make sure that you use one of our recommended Lithium Ion batteries. Some batteries use the same JST connector as ours but have the [opposite polarity](https://learn.sparkfun.com/tutorials/polarity/all#other-polarized-components). Connecting one of these to your smôl power board could destroy it. If you are going to use your own battery, it is up to you to ensure it has the correct polarity. In the above photo, the positive pin is on the right.

### MCP73831 锂离子和锂聚合物充电器

与我们的 [Thing Plus 板](https://www.sparkfun.com/thing_plus)一样，smol 电源板 LiPo 配备了一个 MCP73831 锂离子和锂聚合物充电器 IC。我们将充电电流设置为 100mA，以防止电路板通过柔性印刷电路互连吸取过多电流，并确保使用小型锂离子电池(如我们的 [400mAh 电池](https://www.sparkfun.com/products/13851))的安全性。

当电池通过处理器板从 USB 电源充电时，黄色的 **CHG** LED 将会亮起。

[![Pictured is the MCP73831 battery charger](img/c30fbbc063f08b74f73f5d34f34c01c4.png)](https://cdn.sparkfun.com/assets/learn_tutorials/2/0/5/7/18622_smol_Power_LiPo_MCP73831.jpg)

### MAX17048 燃油表

就像我们的[东西加上 C - ESP32 WROOM](https://www.sparkfun.com/products/18018) 一样，smol 电源板 LiPo 带有一个 MAX17048 I ² C 燃料表 IC。处理器板可以通过 I ² C 与电源板通信，并读取电池电压、充电状态和其他参数。

[![Pictured is the MAX17048 fuel gauge](img/64b1e7c0f86b3036c2f228a21e998c07.png)](https://cdn.sparkfun.com/assets/learn_tutorials/2/0/5/7/18622_smol_Power_LiPo_MAX17048.jpg)

### ATtiny841 AVR 微控制器

smol 电源板 LiPo 是一款*智能*电源板。板载 ATtiny841 微控制器可以监控电池电压、充电状态和其他参数。当处理器板要求时，ATtiny841 将完全关闭 SML 3.3V 电源，并在预定义的时间间隔内进入深度睡眠状态。这使得休眠电流降至 6 A 成为可能。

[![Pictured is the ATtiny841 microcontroller](img/cf16df49ac1af6953a16b4f34d4d3140.png)](https://cdn.sparkfun.com/assets/learn_tutorials/2/0/5/7/18622_smol_Power_LiPo_ATtiny841.jpg)

我们的[spark fun SML 电源板 Arduino 库](https://github.com/sparkfun/SparkFun_smol_Power_Board_Arduino_Library)为您完成所有繁重的工作，通过简单的函数调用轻松与 ATtiny 通信。

### 关于温度传感的一点说明

ATtiny841 内置温度传感器，可通过[spark fun SML 电源板 Arduino 库](https://github.com/sparkfun/SparkFun_smol_Power_Board_Arduino_Library)访问。但是，引用的传感器典型精度是&pm；10 摄氏度是的，*正负十摄氏度*。传感器测量需要外部校准才有用。

### 电压调节器

SML 电源板 LiPo 有两个 3.3V 板载稳压器:一个 AP2112K-3.3V 和一个 STLQ015-3.3V。

[![Pictured are the two 3.3V regulators](img/961a57e07ad5f3051c07472a20208760.png)](https://cdn.sparkfun.com/assets/learn_tutorials/2/0/5/7/18622_smol_Power_LiPo_Regulators.jpg)

AP2112K-3.3V 是我们最喜欢的调节器之一。它提供高达 600mA 的 3.3V 电压，典型压降为 250mV。AP2112K 向 smol 堆栈提供 3.3V 电压，可以由 ATtiny841 处理器完全关闭。这避免了稳压器的 55 A 静态电流消耗你的电池。

STLQ015-3.3V 是新朋友。它在高达 150 毫安时提供 3.3V 电压，典型压降为 112 毫伏。STLQ015 为 ATtiny841 微控制器(仅)提供 3.3V 电源，静态功耗极低，仅为 1.4 A。

### FPC 关系

像我们所有的 SML 板一样，电源板 LiPo 配备了两个 16 路 0.5 毫米间距的柔性印刷电路连接器。FPC 用于以菊花链形式将 SML 板连接在一起。

SML 电源板 LiPo 的引脚排列如下:

| 连接器引脚号 | 信号名称 | 功能 | 笔记 |
| one | 进程 _ 功率 _EN | 处理器电源启用 | 电源板将此信号拉低，以禁用电源板上的电压调节器 |
| Two | 3V3 | 3.3V 电源轨 |  |
| three | GND | 电源接地/ 0V |  |
| four | SCLK | SPI 时钟 | 未使用 |
| five | 科皮 | SPI 控制器输出外设输入 | 未使用 |
| six | 奇波 | SPI 控制器输入外设输出 | 未使用 |
| seven | CS0 | SPI 片选 0 | 未使用 |
| eight | CS1 | SPI 片选 1 | 未使用 |
| nine | CS2 | SPI 片选 2 | 未使用 |
| Ten | GPIO0 | 通用输入/输出 0 | 未使用 |
| Eleven | GPIO1 | 通用输入/输出 1 | 未使用 |
| Twelve | 国家药品监督管理局 | I ² C 数据 | 用于 ATtiny841 和燃油表通信 |
| Thirteen | SCL | I ² C 时钟 | 用于 ATtiny841 和燃油表通信 |
| Fourteen | GND | 电源接地/ 0V |  |
| Fifteen | 3V3 | 3.3V 电源轨 |  |
| Sixteen | V_USB | USB 电源轨(5V) | USB 电源用于给电池充电 |

SML 电源板 LiPo 上的 IN 和 OUT 引脚连接是相同的。(SML 外围设备板并不总是如此。查看相应的外围设备板连接指南，了解全部详情。)

连接 SML 板的顺序很重要。但是因为电源板 LiPo 只使用 I ² C 通信，所以可以放在栈的任何地方。请参阅 SML 连接指南了解更多详情。

[Get started with the smôl Hookup Guide](https://learn.sparkfun.com/tutorials/sml-hookup-guide)

## SML 细节

### 界面:

*   接口:I ² C
    *   ATtiny841 默认地址:0x50
    *   MAX17048 燃油表地址:0x36

### 进程 _ 功率 _EN:

*   进程 _ 功率 _EN:
    *   电源板将 PROC_PWR_EN 拉低，以禁用处理器板上的调节器

## Arduino 示例:电池电压

如果您使用的是 SML ESP32 处理器板，您需要首先为 ESP32 安装 CP210x USB 驱动程序和 Arduino 板软件包。请参见[smol ESP32 连接指南](https://learn.sparkfun.com/tutorials/sml-esp32-hookup-guide)了解更多详情。

SML 电源板有自己的 Arduino 库，使与板的通信像调用函数一样简单。你可以通过 Arduino IDE 库管理器搜索 **SparkFun smol power** 来安装这个库。或者，你可以从 [GitHub](https://github.com/sparkfun/SparkFun_smol_Power_Board_Arduino_Library) 下载这个库，或者点击下面的按钮下载成 zip 文件:

[SparkFun smôl Power Board Arduino Library (ZIP)](https://github.com/sparkfun/SparkFun_smol_Power_Board_Arduino_Library/archive/main.zip)

您还需要安装 SparkFun MAX1704x 燃油表 Arduino 库。同样，你可以通过 Arduino IDE 库管理器搜索 **SparkFun MAX1704x** 来安装这个库。或者，你可以从 [GitHub](https://github.com/sparkfun/SparkFun_MAX1704x_Fuel_Gauge_Arduino_Library) 下载这个库，或者点击下面的按钮下载成 zip 文件:

[SparkFun MAX1704x Fuel Gauge Arduino Library (ZIP)](https://github.com/sparkfun/SparkFun_MAX1704x_Fuel_Gauge_Arduino_Library/archive/main.zip)

电源板库包含一组[经过试验和测试的示例](https://github.com/sparkfun/SparkFun_smol_Power_Board_Arduino_Library/tree/main/examples)，它们将与 SML 电源板 LiPo 和 SML 电源板 AAA 一起工作。从一个切换到另一个时，只需要更改一行代码。

以下代码是 [Example2_BatteryVoltage](https://github.com/sparkfun/SparkFun_smol_Power_Board_Arduino_Library/blob/main/examples/Example2_BatteryVoltage/Example2_BatteryVoltage.ino) 的简化版。将代码上传到处理器板上，打开串行监视器或 115200 波特的终端仿真器，查看输出。

```
language:c
#include <Wire.h>

#include <SparkFun_MAX1704x_Fuel_Gauge_Arduino_Library.h> // Click here to get the library: http://librarymanager/All#SparkFun_MAX1704x_Fuel_Gauge_Arduino_Library
#include <SparkFun_smol_Power_Board.h> //Click here to get the library:  http://librarymanager/All#SparkFun_smol_Power_Board

smolPowerLiPo myPowerBoard;

void setup()
{
  Serial.begin(115200);
  while (!Serial)
    ; // Wait for the user to open the Serial console
  Serial.println(F("smôl Power Board example"));
  Serial.println();

  Wire.begin();

  if (myPowerBoard.begin() == false) // Begin communication with the power board using the default I2C address (0x50) and the Wire port
  {
    Serial.println(F("Could not communicate with the power board. Please check the I2C connections. Freezing..."));
    while (1)
      ;
  }

  float voltage = myPowerBoard.getBatteryVoltage(); // Read the battery voltage from the fuel gauge
  Serial.print(F("The battery voltage reads as: "));
  Serial.println(voltage);

  if (voltage == -99.0)
  {
    Serial.println(F("A voltage of -99.0V indicates an error."));
  }
}

void loop()
{
  //Nothing to do here
} 
```

## 解决纷争

如果您的 SML 堆栈没有通信，它可能处于深度睡眠状态。当处理器板命令电源板进入深度睡眠时，它再次唤醒它的唯一方式是当睡眠间隔到期时。您不能通过 USB 接口唤醒或重置系统。

移除并重新插入电池连接将重置电源板并再次唤醒它。

我们没有在 SML 电源板上包括复位按钮，以使板尽可能小。但是，您可以通过电路板底部的 ISP 编程测试点重置它。将 RESET 短接至 GND，以重置电路板。

[![Pictured are the RESET and GND test points on the bottom of the board](img/0763619f55df18d98249563a50d770f1.png)](https://cdn.sparkfun.com/assets/learn_tutorials/2/0/5/7/18622_smol_Power_Reset_Pin.jpg)**Not working as expected and need help?** [SparkX](https://www.sparkfun.com/sparkx) products are rapidly produced to bring you the most cutting edge technology as it becomes available. These products are tested but come with no guarantees. Live technical support is not available for SparkX products. Head on over to our [forum](https://forum.sparkfun.com/viewforum.php?f=123) for support or to ask a question and we will get back to you as soon as we can.

## 资源和更进一步

有关 SML 电源板 LiPo 的更多信息，请查看以下链接:

**SML 电源板 LiPo 文档:**

*   [示意图](https://cdn.sparkfun.com/assets/d/6/6/f/1/Schematic.pdf)
*   [老鹰档案](https://cdn.sparkfun.com/assets/a/2/5/b/a/SparkX_smol_LiPo_Power.zip)
*   [GitHub 硬件回购](https://github.com/sparkfunX/SparkX_smol_Power_Board_LiPo)
*   [spark fun SML 电源板 Arduino 库](https://github.com/sparkfun/SparkFun_smol_Power_Board_Arduino_Library)
*   [Arduino 示例](https://github.com/sparkfun/SparkFun_smol_Power_Board_Arduino_Library/tree/main/examples)

**锂离子/锂聚合物充电器:**

*   [数据表](https://cdn.sparkfun.com/datasheets/Components/General%20IC/33244_SPCN.pdf) (MCP73831)

**电池电量计:**

*   [数据表](https://cdn.sparkfun.com/assets/5/2/7/6/6/MAX17048-MAX17049.pdf) (MAX17048)

**微控制器:**

*   [数据表](https://cdn.sparkfun.com/assets/7/a/b/e/2/Atmel-8495-8-bit-AVR-Microcontrollers-ATtiny441-ATtiny841_Datasheet.pdf) (ATtiny841)

**SML 文档:**

*   [SML 连接指南](https://learn.sparkfun.com/tutorials/sml-hookup-guide)*************************